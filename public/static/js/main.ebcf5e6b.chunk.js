(this["webpackJsonpattack-app"]=this["webpackJsonpattack-app"]||[]).push([[0],{100:function(e,t,c){},101:function(e,t,c){},148:function(e,t,c){"use strict";c.r(t);var n=c(2),a=c(0),r=c(10),s=c.n(r),i=(c(100),c(12)),o=(c(101),c(27)),l=c(18),d=c(23),j=c.n(d),u=c(37),b=c(86),h=c.n(b).a.create({withCredentials:!0}),x="/api/attack",O={query:function(e){return p.apply(this,arguments)},getAttackById:function(e){return f.apply(this,arguments)}};function p(){return(p=Object(u.a)(j.a.mark((function e(t){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.get(x,{params:t});case 3:return c=e.sent,e.abrupt("return",c.data);case 7:e.prev=7,e.t0=e.catch(0),console.log("error with query ",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function f(){return(f=Object(u.a)(j.a.mark((function e(t){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.get("".concat(x,"/").concat(t));case 3:return c=e.sent,e.abrupt("return",c.data);case 7:e.prev=7,e.t0=e.catch(0),console.log("error with getting attack by id",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}var m=function(e){return{type:"SET_ATTACKS",attacks:e}};function v(e){return function(){var t=Object(u.a)(j.a.mark((function t(c){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.query(e);case 3:n=t.sent,c(m(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log("Error with set attacks ",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}function g(e){return function(t){return t(function(e){return{type:"SET_FILTER",filterBy:e}}(e))}}var k=c(186),_=c(197),S=c(198),w=c(192),y=c(191),N=c(88),T=c.n(N),C=c(193),I=c(33),D=c.n(I),P=c(29),R=c(9),E=c(87);function A(e){var t=new R.Document({sections:[{properties:{},children:[new R.Paragraph({children:[new R.TextRun({text:"".concat(e.objects[0].name," Attack"),bold:!0,color:"blue",font:"Segoe UI"})]}),new R.Paragraph({children:[new R.TextRun({text:"ID: ",bold:!0,font:"Segoe UI"}),new R.TextRun({text:" ".concat(e.objects[0].id),bold:!0,font:"Segoe UI"})]}),new R.Paragraph({children:[new R.TextRun({text:"Platforms: ",bold:!0,font:"Segoe UI"}),new R.TextRun({text:" ".concat(e.objects[0].x_mitre_platforms.toString()),bold:!0,font:"Segoe UI"})]}),new R.Paragraph({children:[new R.TextRun({text:"Created: ",bold:!0,font:"Segoe UI"}),new R.TextRun({text:" ".concat(D()(e.objects[0].created).calendar()),bold:!0,font:"Segoe UI"})]}),new R.Paragraph({children:[new R.TextRun({text:"Modified: ",bold:!0,font:"Segoe UI"}),new R.TextRun({text:" ".concat(D()(e.objects[0].modified).calendar()),bold:!0,font:"Segoe UI"})]}),new R.Paragraph({children:[new R.TextRun({text:"Phase name: ",bold:!0,font:"Segoe UI"}),new R.TextRun({text:" ".concat(e.objects[0].kill_chain_phases[0].phase_name),font:"Segoe UI"})]}),new R.Paragraph({spacing:{before:300},children:[new R.TextRun({text:"Description: ",bold:!0,font:"Segoe UI"}),new R.TextRun({text:" ".concat(e.objects[0].description),font:"Segoe UI"})]}),new R.Paragraph({spacing:{before:300},children:[new R.TextRun({text:"Detection: ",bold:!0,font:"Segoe UI"}),new R.TextRun({text:"  ".concat(e.objects[0].x_mitre_detection),font:"Segoe UI"})]})]}]});R.Packer.toBlob(t).then((function(t){Object(E.saveAs)(t,"".concat(e.objects[0].name,".docx")),console.log("Document created successfully")}))}var B=Object(k.a)((function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular}}}));function U(e){var t=e.attack,c=B(),a=t.objects[0],r=a.id,s=a.name,i=a.created,o=a.description;return Object(n.jsx)("section",{className:c.root,children:Object(n.jsxs)(_.a,{children:[Object(n.jsx)(S.a,{expandIcon:Object(n.jsx)(T.a,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:Object(n.jsx)(y.a,{className:c.heading,children:Object(n.jsx)("span",{className:"headline",children:s})})}),Object(n.jsx)(w.a,{children:Object(n.jsxs)(y.a,{component:"div",variant:"body2",children:[Object(n.jsxs)("div",{id:"exportContent",children:[Object(n.jsx)("span",{className:"headline",children:"Attack ID:"})," ",Object(n.jsx)("p",{children:r}),Object(n.jsx)("span",{className:"headline",children:"Created: "})," ",Object(n.jsx)("p",{children:D()(i).calendar()}),Object(n.jsx)("div",{children:o&&Object(n.jsxs)("div",{children:[" ",Object(n.jsx)("span",{className:"headline",children:"Description:"})," ",Object(n.jsx)("p",{children:o})]})})]}),Object(n.jsxs)("div",{className:"actions",children:[Object(n.jsx)("div",{children:t.objects[0].x_mitre_detection&&Object(n.jsx)(C.a,{onClick:function(){return A(t)},variant:"contained",children:"Export as .docx"})}),Object(n.jsx)(P.b,{to:"/".concat(t._id),children:Object(n.jsxs)("div",{className:"details-btn",children:[" ",Object(n.jsx)(C.a,{variant:"contained",children:"Details"})]})})]})]})})]})})}function M(e){var t=e.attack;return Object(n.jsx)("li",{className:"attack-preview",children:Object(n.jsx)(U,{attack:t})})}function L(e){var t=e.attacks;return Object(n.jsx)("ul",{className:"list-container",children:t.map((function(e){return Object(n.jsx)(M,{attack:e},e._id)}))})}var F=c(194),W=Object(k.a)((function(e){return{root:{display:"flex","& > * + *":{marginLeft:e.spacing(2)}}}}));function q(){var e=W();return Object(n.jsx)("div",{className:e.root,children:Object(n.jsx)(F.a,{})})}var K=c(196),z=Object(k.a)((function(e){return{root:{"& > *":{marginTop:e.spacing(2)}}}}));function G(e){var t=e.page,c=e.noOfPages,a=e.onChangePage,r=z();return Object(n.jsx)("div",{className:r.root,children:Object(n.jsx)(K.a,{count:c,page:t,onChange:a,defaultPage:1,showFirstButton:!0,showLastButton:!0,size:"large"})})}var J=c(61),V=c(25),X=c(195),H=Object(k.a)((function(e){return{root:{"& > *":{margin:e.spacing(1),width:"25ch"}}}}));function Y(e){var t=e.dataSource,c=H(),r=Object(a.useState)({name:"",description:""}),s=Object(o.a)(r,2),i=s[0],d=s[1],j=Object(l.b)(),u=function(e){var t=e.target,c=t.name,n=t.value,a=Object(V.a)({},i);a=Object(V.a)(Object(V.a)({},i),{},Object(J.a)({},c,n)),d(a)},b=function(){d({name:"",description:""}),j(g({name:"",description:"",dataSource:null}))};return t?Object(n.jsxs)("div",{className:"data-source-container",children:[Object(n.jsxs)("h2",{className:"data-source",children:["Showing attacks with data source: ",t]}),Object(n.jsx)(C.a,{variant:"contained",type:"button",onClick:b,children:"Load full list"})]}):Object(n.jsx)("section",{className:"filter-container",children:Object(n.jsxs)("form",{className:"form-filter ".concat(c.root),noValidate:!0,autoComplete:"off",onSubmit:function(e){return function(e){console.log("search"),e.preventDefault(),j(g(i))}(e)},children:[Object(n.jsx)(X.a,{id:"standard-basic",label:"Name",onChange:function(e){return u(e)},value:i.name,name:"name"}),Object(n.jsx)(X.a,{id:"standard-basic",label:"Description",onChange:function(e){return u(e)},value:i.description,name:"description"}),Object(n.jsxs)(C.a,{type:"submit",variant:"contained",children:[" ",Object(n.jsx)("strong",{children:"Search"})," "]}),Object(n.jsx)(C.a,{variant:"contained",type:"button",onClick:b,children:Object(n.jsx)("strong",{children:"Reset"})})]})})}var $=c(69),Q=c.n($),Z={createStatistics:function(e){return e.reduce((function(e,t){return t.objects[0].x_mitre_platforms&&t.objects[0].x_mitre_platforms.map((function(t){var c=e.platforms[t];e.platforms[t]=c?c+1:1})),t.objects[0].x_mitre_data_sources&&t.objects[0].x_mitre_data_sources.map((function(t){var c=e.dataSources[t];e.dataSources[t]=c?c+1:1})),e}),{platforms:{},dataSources:{}})},createPieData:function(e){return{series:Object.values(e.platforms),options:{chart:{width:600,type:"pie"},labels:Object.keys(e.platforms),responsive:[{breakpoint:480,options:{chart:{width:400},legend:{position:"bottom"}}}]}}},createBarData:function(e){return{series:[{name:"Attacks",data:Object.values(e.dataSources)}],options:{annotations:{points:[{x:"Attacks",seriesIndex:0,label:{borderColor:"#775DD0",offsetY:0,style:{color:"#fff",background:"#775DD0"},text:""}}]},chart:{height:350,type:"bar"},plotOptions:{bar:{borderRadius:10,columnWidth:"50%"}},dataLabels:{enabled:!1},stroke:{width:2},grid:{row:{colors:["#fff","#f2f2f2"]}},xaxis:{labels:{rotate:-45},categories:Object.keys(e.dataSources),tickPlacement:"on"},yaxis:{title:{text:"Data Sources"}},fill:{type:"gradient",gradient:{shade:"light",type:"horizontal",shadeIntensity:.25,gradientToColors:void 0,inverseColors:!0,opacityFrom:.85,opacityTo:.85,stops:[50,0,100]}}}}}};var ee=[{path:"/:attackId",component:function(e){var t=Object(a.useState)(null),c=Object(o.a)(t,2),r=c[0],s=c[1],i=Object(l.c)((function(e){return e.attackModule})).attacks,d=Object(l.b)();Object(a.useEffect)((function(){b()}),[]);var b=function(){var t=Object(u.a)(j.a.mark((function t(){var c,n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=e.match.params.attackId,t.next=3,O.getAttackById(c);case 3:n=t.sent,s(n);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();if(!r)return Object(n.jsx)(q,{});var h=r.objects[0],x=h.name,p=h.created,f=h.description,m=h.id,v=h.modified,g=h.x_mitre_contributors,k=h.kill_chain_phases,_=h.x_mitre_data_sources,S=h.x_mitre_detection,w=h.x_mitre_permissions_required,y=h.x_mitre_platforms;return Object(n.jsxs)("section",{className:"details-container max-layout",children:[Object(n.jsxs)("div",{className:"details-actions",children:[Object(n.jsx)(P.b,{to:"/",children:Object(n.jsx)(C.a,{variant:"contained",children:"Back"})}),r.objects[0].x_mitre_detection&&Object(n.jsx)("div",{children:Object(n.jsx)(C.a,{onClick:function(){return A(r)},variant:"contained",children:"Export as .docx"})})]}),Object(n.jsx)("h1",{children:x}),Object(n.jsxs)("div",{children:[Object(n.jsx)("strong",{children:"Created:"})," ",Object(n.jsx)("span",{children:D()(p).calendar()})]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("strong",{children:"Modified:"})," ",Object(n.jsx)("span",{children:D()(v).calendar()})]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("strong",{children:"Id: "})," ",Object(n.jsx)("span",{children:m})]}),Object(n.jsx)("div",{children:k?Object(n.jsxs)("div",{children:[" ",Object(n.jsx)("strong",{children:"phase name:"})," ",Object(n.jsx)("span",{children:k[0].phase_name})]}):Object(n.jsxs)("div",{children:[Object(n.jsx)("strong",{children:"kill_chain_phases"})," ",Object(n.jsx)("span",{children:": NA"})," "]})}),Object(n.jsx)("div",{children:y&&Object(n.jsxs)("div",{className:"inline",children:[" ",Object(n.jsx)("span",{className:"headline",children:"Platforms:"}),Object(n.jsx)("div",{children:y.map((function(e){return Object(n.jsx)("span",{children:" ".concat(e," ")},e)}))})]})}),Object(n.jsx)("div",{children:w&&Object(n.jsxs)("div",{className:"inline",children:[" ",Object(n.jsx)("span",{className:"headline",children:"Permissions:"}),Object(n.jsx)("div",{children:w.map((function(e){return Object(n.jsx)("span",{children:" ".concat(e," ")},e)}))})]})}),Object(n.jsx)("div",{children:f&&Object(n.jsxs)("div",{children:[" ",Object(n.jsx)("span",{className:"headline",children:"Description:"})," ",Object(n.jsx)("p",{children:f})]})}),Object(n.jsx)("div",{children:S&&Object(n.jsxs)("div",{children:[" ",Object(n.jsx)("span",{className:"headline",children:"Detection:"})," ",Object(n.jsx)("p",{children:S})]})}),Object(n.jsx)("div",{children:_&&Object(n.jsxs)("div",{className:"inline",children:[" ",Object(n.jsx)("span",{className:"headline",children:"Data Sources(tags):"}),Object(n.jsx)("div",{children:_.map((function(t){return Object(n.jsxs)("span",{onClick:function(){return function(t){var c=i.filter((function(e){return!!e.objects[0].x_mitre_data_sources&&e.objects[0].x_mitre_data_sources.includes(t)}));d(function(e,t){return function(c){return c({type:"SET_COMMON_TAGS_ATTACK",attacksWithDataSource:{attacks:e,dataSource:t}})}}(c,t)),e.history.push("/")}(t)},className:"data-source-tag",children:["#".concat(t)," "]},t)}))})]})}),Object(n.jsx)("div",{children:r.objects[0].external_references[0]&&Object(n.jsxs)("div",{className:"inline",children:[" ",Object(n.jsx)("span",{className:"headline",children:"Read more:"}),Object(n.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:r.objects[0].external_references[0].url,children:r.objects[0].external_references[0].url})]})}),Object(n.jsx)("div",{children:g&&Object(n.jsxs)("div",{className:"inline",children:[" ",Object(n.jsx)("span",{className:"headline",children:"Contributors:"}),Object(n.jsx)("div",{children:g.map((function(e){return Object(n.jsx)("span",{children:" ".concat(e," ")},e)}))})]})}),Object(n.jsx)("div",{className:"export-btn"})]})}},{path:"/attack/statistics",component:function(){var e=Object(a.useState)(null),t=Object(o.a)(e,2),c=t[0],r=t[1],s=Object(a.useState)(null),i=Object(o.a)(s,2),d=i[0],j=i[1],u=Object(l.c)((function(e){return e.attackModule})).attacks;Object(a.useEffect)((function(){b()}),[u]);var b=function(){if(u){console.log(u);var e=Z.createStatistics(u);r(Z.createPieData(e)),j(Z.createBarData(e))}};return u&&c&&d?Object(n.jsxs)("section",{className:"statistics-container max-layout",children:[Object(n.jsxs)("div",{className:"pie-chart",children:[Object(n.jsx)("h2",{children:"Platforms"}),Object(n.jsx)("h3",{children:"Attacks per platform"}),Object(n.jsx)(Q.a,{options:c.options,series:c.series,type:"pie",width:500})]}),Object(n.jsxs)("div",{className:"bar-chart",children:[Object(n.jsx)("h2",{children:"Data sources"}),Object(n.jsx)("h3",{children:"Attacks per data source"}),Object(n.jsx)(Q.a,{options:d.options,series:d.series,type:"bar",height:500})]})]}):Object(n.jsx)(q,{})}},{path:"/",component:function(){var e=Object(l.c)((function(e){return e.attackModule})),t=e.attacks,c=e.filterBy,r=e.dataSource,s=Object(l.b)(),i=Object(a.useState)(1),d=Object(o.a)(i,2),j=d[0],u=d[1],b=Object(a.useState)(10),h=Object(o.a)(b,2),x=h[0],O=h[1];Object(a.useEffect)((function(){p()}),[c]),Object(a.useEffect)((function(){f()}),[t]);var p=function(){r||s(v(c))},f=function(){t&&O(Math.ceil(t.length/7))};return t?Object(n.jsxs)("section",{className:"app-container max-layout",children:[Object(n.jsx)(Y,{dataSource:r}),Object(n.jsx)("h1",{children:"Attacks list"}),Object(n.jsx)(L,{attacks:t.slice(7*(j-1),7*j)}),Object(n.jsx)("div",{className:"pagination-container",children:Object(n.jsx)(G,{noOfPages:x,page:j,onChangePage:function(e,t){u(t)}})})]}):Object(n.jsxs)("section",{className:"loading-container",children:[Object(n.jsx)(Y,{dataSource:r}),Object(n.jsx)(q,{})]})}}];function te(){return Object(n.jsx)("section",{className:"header-container",children:Object(n.jsx)("div",{className:"header-hero max-layout",children:Object(n.jsx)("nav",{children:Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{children:Object(n.jsx)(P.c,{exact:!0,activeClassName:"selected",to:"/",children:"Home"})}),Object(n.jsx)("li",{children:Object(n.jsx)(P.c,{activeClassName:"selected",to:"/attack/statistics",children:"Statistics"})})]})})})})}function ce(){var e=Object(l.c)((function(e){return e.attackModule})).dataSource,t=Object(l.b)();Object(a.useEffect)((function(){c()}),[]);var c=function(){e||t(v())};return Object(n.jsxs)("div",{className:"app",children:[Object(n.jsx)(te,{}),Object(n.jsx)(i.c,{children:ee.map((function(e){return Object(n.jsx)(i.a,{exact:!0,component:e.component,path:e.path},e.path)}))})]})}var ne=c(89),ae=c(39),re={attacks:null,dataSource:null,filterBy:{name:"",description:""}};var se=Object(ae.c)({attackModule:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ATTACKS":return Object(V.a)(Object(V.a)({},e),{},{attacks:t.attacks});case"SET_FILTER":return Object(V.a)(Object(V.a)({},e),{},{filterBy:t.filterBy,dataSource:t.dataSource});case"SET_COMMON_TAGS_ATTACK":return Object(V.a)(Object(V.a)({},e),{},{attacks:t.attacksWithDataSource.attacks,dataSource:t.attacksWithDataSource.dataSource});default:return e}}}),ie=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ae.d,oe=Object(ae.e)(se,ie(Object(ae.a)(ne.a)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var le=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,200)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;c(e),n(e),a(e),r(e),s(e)}))};s.a.render(Object(n.jsx)(l.a,{store:oe,children:Object(n.jsx)(P.a,{children:Object(n.jsx)(ce,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),le()}},[[148,1,2]]]);
//# sourceMappingURL=main.ebcf5e6b.chunk.js.map